<html>
<head>
	<title>car</title>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
</head>
<body>
	<div class="header"></div>
	<div class="content">
		<div class="test">
			{% for item in ports %}
                <button class="testbutton" id="button{{item}}" style="background:#aaaaaa;">{{item}}</button>
            {% endfor %}
		</div>
        <br>
        <div class="carcontrol">
            
        </div>
	</div>
    <script type="text/javascript">   
    function buttonid(num){
        return "#button"+num;
    } 
   
    function showbuttoncolor(){
        $.get("/getstatus",function(data,status){
            data = data.slice(1,-1).split(",")
            $(".testbutton").css("background","#aaaaaa");
            console.log(data);
            
            for(var i=0;i<data.length;i++){
                (function(data){
                    $(buttonid(data)).css("background","#555555");
                    console.log(data+"changed");                    
                })(data[i]);
            }                
            
    
        });
    }
    function initbutton(i){
        $(buttonid(i)).click(function(){
            $.post("/changeport",{"port":i},function(data,status){
                console.log(data);
                console.log(status);               
            });
            showbuttoncolor();
        });  
    }
    
    for(var i=1;i<=Number({{maxport}});i++){
        initbutton(i);
    }   
    showbuttoncolor();
    </script>    
</body>
</html>
